<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>开始使用 layui</title>
    <link rel="shortcut icon" href="#" />
    <link href="layui/css/layui.css" rel="stylesheet">
</head>
<body>

<div class="layui-form-item">
    <label class="layui-form-label">交易号前缀</label>
    <div class="layui-input-block">
        <input type="text" name="jyhqz" id="jyh" required  lay-verify="required" placeholder="请输入交易号前缀" autocomplete="off" class="layui-input">
    </div>
</div>

<button type="button" class="layui-btn" id="file">
    <i class="layui-icon">&#xe67c;</i>上传文件
</button>
<button type="button" class="layui-btn layui-btn-normal" id="submit">
    <i class="layui-icon">&#xe67c;</i>提交
</button>
<script type="text/javascript" src="jquery-3.6.0.min.js"></script>
<script type="text/javascript" src="layui/layui.js"></script>
<script>
    layui.use('upload', function(){
        var upload = layui.upload;
        //执行实例
        upload.render({
            elem: '#file' //绑定元素
            ,url: '/upload/' //上传接口
            ,auto:'false'
            ,bindAction:'#submit'
            ,accept:'file'
            ,method:'post'
            ,data:{
                jyhqz: function(){
                    return ($('#jyh').val());
                }
            },done:function (res){
                saveStringToFile("test.xlsx",res);
                alert(res);
            }
        });
    });
    function saveStringToFile(filename, str) {

        // 创建一个 <a> 标签对象
        var linkTag = window.document.createElement("a");
        // 设置该实例的 download 和 href 属性(HTML 5 标准属性)
        linkTag.download = filename;
        linkTag.href = window.URL.createObjectURL(new Blob([str]));

        // 把刚才手动创建的 <a> 添加到 DOM 文档中
        window.document.body.appendChild(linkTag);
        linkTag.click();    // 调用点击事件
        // 移除刚才添加的子标签
        window.document.body.removeChild(linkTag);

    }
</script>

</body>
</html>